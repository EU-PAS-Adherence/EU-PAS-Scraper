{
    "$schema": "https://json-schema.org/draft/2020-12/schema",
    "$id": "https://example.com/study.schema.json",
    "title": "Study",
    "description": "A study in the EU PAS register",
    "type": "object",
    "required": [
        "state",
        "eu_pas_register_number",
        "title",
        "update_date",
        "url",
        "registration_date",
        "study_type",
        "requested_by_regulator",
        "collaboration_with_research_network",
        "country_type",
        "countries",
        "medical_conditions",
        "age_population",
        "sex_population",
        "number_of_subjects",
        "uses_established_data_source",
        "data_source_types",
        "scopes",
        "primary_scope",
        "primary_outcomes",
        "secondary_outcomes",
        "study_design",
        "follow_up"
    ],
    "dependentRequired": {
        "centre_name": ["centre_location"],
        "centre_location": ["centre_name"],
        "centre_organisation": ["centre_name_of_investigator"],
        "funding_companies_names": ["funding_companies_percentage"],
        "funding_companies_percentage": ["funding_companies_names"],
        "funding_charities_names": ["funding_charities_percentage"],
        "funding_charities_percentage": ["funding_charities_names"],
        "funding_government_body_names": ["funding_government_body_percentage"],
        "funding_government_body_percentage": ["funding_government_body_names"],
        "funding_research_councils_names": ["funding_research_councils_percentage"],
        "funding_research_councils_percentage": ["funding_research_councils_names"],
        "funding_eu_scheme_names": ["funding_eu_scheme_percentage"],
        "funding_eu_scheme_percentage": ["funding_eu_scheme_names"],
        "funding_other_names": ["funding_other_percentage"],
        "funding_other_percentage": ["funding_other_names"]
    },
    "properties": {
        "state": {
            "type": "string",
            "enum": ["Finalised", "Ongoing", "Planned"]
        },
        "eu_pas_register_number": {
            "type": "string",
            "pattern": "^EUPAS\\d{4,6}$"
        },
        "title": {
            "type": "string",
            "minLength": 1,
            "maxLength": 1000
        },
        "update_date": {
            "type": "string",
            "pattern": "^(?:(?:31(\\/)(?:0?[13578]|1[02]))\\1|(?:(?:29|30)(\\/)(?:0?[13-9]|1[0-2])\\2))(?:(?:1[6-9]|[2-9]\\d)?\\d{2})$|^(?:29(\\/)0?2\\3(?:(?:(?:1[6-9]|[2-9]\\d)?(?:0[48]|[2468][048]|[13579][26])|(?:(?:16|[2468][048]|[3579][26])00))))$|^(?:0?[1-9]|1\\d|2[0-8])(\\/)(?:(?:0?[1-9])|(?:1[0-2]))\\4(?:(?:1[6-9]|[2-9]\\d)?\\d{2})$",
            "minLength": 10,
            "maxLength": 10
        },
        "url": {
            "type": "string",
            "pattern": "^https://www\\.encepp\\.eu/encepp/viewResource\\.htm\\;\\?id=\\d{4,6}$"
        },
        "registration_date": {
            "type": "string",
            "pattern": "^(?:(?:31(\\/)(?:0?[13578]|1[02]))\\1|(?:(?:29|30)(\\/)(?:0?[13-9]|1[0-2])\\2))(?:(?:1[6-9]|[2-9]\\d)?\\d{2})$|^(?:29(\\/)0?2\\3(?:(?:(?:1[6-9]|[2-9]\\d)?(?:0[48]|[2468][048]|[13579][26])|(?:(?:16|[2468][048]|[3579][26])00))))$|^(?:0?[1-9]|1\\d|2[0-8])(\\/)(?:(?:0?[1-9])|(?:1[0-2]))\\4(?:(?:1[6-9]|[2-9]\\d)?\\d{2})$",
            "minLength": 10,
            "maxLength": 10
        },
        "acronym": {
            "type": "string",
            "minLength": 1,
            "maxLength": 100
        },
        "study_type": {
            "type": "string",
            "oneOf": [
                { "enum": ["Active surveillance", "Clinical trial", "Observational study"]},
                { "pattern": "^Other: "},
                { "pattern": "^Clinical trial; EUDRACT number: \\d{4}-\\d{6}-\\d{2}$"}
            ]
        },
        "requested_by_regulator": {
            "type": "string",
            "oneOf": [
                { "enum": ["Don't know","No"]},
                { "pattern": "^Yes: "}
            ]
        },
        "risk_managment_plan": {
            "type": "string",
            "enum": [
                "EU RMP category 1 (imposed as condition of marketing authorisation)",
                "EU RMP category 2 (specific obligation of marketing authorisation)",
                "EU RMP category 3 (required)",
                "Non-EU RMP only",
                "Not applicable"
            ]
        },
        "regulatory_procedure_number": {
            "type": "string",
            "minLength": 1
        },
        "centre_name": {
            "type": "string",
            "minLength": 1
        },
        "centre_location": {
            "type": "string",
            "minLength": 1
        },
        "centre_name_of_investigator": {
            "type": "string",
            "minLength": 1
        },
        "centre_organisation": {
            "type": "string",
            "minLength": 1
        },
        "collaboration_with_research_network": {
            "type": "string",
            "enum": ["Yes", "No"]
        },
        "country_type": {
            "type": "string",
            "enum": ["National study", "International study"]
        },
        "countries": {
            "type": "array",
            "items": {
                "type": "string",
                "minLength": 1
            },
            "minItems": 1,
            "uniqueItems": true
        },
        "funding_contract_date_planed": {
            "type": "string",
            "pattern": "^(?:(?:31(\\/)(?:0?[13578]|1[02]))\\1|(?:(?:29|30)(\\/)(?:0?[13-9]|1[0-2])\\2))(?:(?:1[6-9]|[2-9]\\d)?\\d{2})$|^(?:29(\\/)0?2\\3(?:(?:(?:1[6-9]|[2-9]\\d)?(?:0[48]|[2468][048]|[13579][26])|(?:(?:16|[2468][048]|[3579][26])00))))$|^(?:0?[1-9]|1\\d|2[0-8])(\\/)(?:(?:0?[1-9])|(?:1[0-2]))\\4(?:(?:1[6-9]|[2-9]\\d)?\\d{2})$",
            "minLength": 10,
            "maxLength": 10
        },
        "funding_contract_date_actual": {
            "type": "string",
            "pattern": "^(?:(?:31(\\/)(?:0?[13578]|1[02]))\\1|(?:(?:29|30)(\\/)(?:0?[13-9]|1[0-2])\\2))(?:(?:1[6-9]|[2-9]\\d)?\\d{2})$|^(?:29(\\/)0?2\\3(?:(?:(?:1[6-9]|[2-9]\\d)?(?:0[48]|[2468][048]|[13579][26])|(?:(?:16|[2468][048]|[3579][26])00))))$|^(?:0?[1-9]|1\\d|2[0-8])(\\/)(?:(?:0?[1-9])|(?:1[0-2]))\\4(?:(?:1[6-9]|[2-9]\\d)?\\d{2})$",
            "minLength": 10,
            "maxLength": 10
        },
        "data_collection_date_planed": {
            "type": "string",
            "pattern": "^(?:(?:31(\\/)(?:0?[13578]|1[02]))\\1|(?:(?:29|30)(\\/)(?:0?[13-9]|1[0-2])\\2))(?:(?:1[6-9]|[2-9]\\d)?\\d{2})$|^(?:29(\\/)0?2\\3(?:(?:(?:1[6-9]|[2-9]\\d)?(?:0[48]|[2468][048]|[13579][26])|(?:(?:16|[2468][048]|[3579][26])00))))$|^(?:0?[1-9]|1\\d|2[0-8])(\\/)(?:(?:0?[1-9])|(?:1[0-2]))\\4(?:(?:1[6-9]|[2-9]\\d)?\\d{2})$",
            "minLength": 10,
            "maxLength": 10
        },
        "data_collection_date_actual": {
            "type": "string",
            "pattern": "^(?:(?:31(\\/)(?:0?[13578]|1[02]))\\1|(?:(?:29|30)(\\/)(?:0?[13-9]|1[0-2])\\2))(?:(?:1[6-9]|[2-9]\\d)?\\d{2})$|^(?:29(\\/)0?2\\3(?:(?:(?:1[6-9]|[2-9]\\d)?(?:0[48]|[2468][048]|[13579][26])|(?:(?:16|[2468][048]|[3579][26])00))))$|^(?:0?[1-9]|1\\d|2[0-8])(\\/)(?:(?:0?[1-9])|(?:1[0-2]))\\4(?:(?:1[6-9]|[2-9]\\d)?\\d{2})$",
            "minLength": 10,
            "maxLength": 10
        },
        "data_analysis_date_planed": {
            "type": "string",
            "pattern": "^(?:(?:31(\\/)(?:0?[13578]|1[02]))\\1|(?:(?:29|30)(\\/)(?:0?[13-9]|1[0-2])\\2))(?:(?:1[6-9]|[2-9]\\d)?\\d{2})$|^(?:29(\\/)0?2\\3(?:(?:(?:1[6-9]|[2-9]\\d)?(?:0[48]|[2468][048]|[13579][26])|(?:(?:16|[2468][048]|[3579][26])00))))$|^(?:0?[1-9]|1\\d|2[0-8])(\\/)(?:(?:0?[1-9])|(?:1[0-2]))\\4(?:(?:1[6-9]|[2-9]\\d)?\\d{2})$",
            "minLength": 10,
            "maxLength": 10
        },
        "data_analysis_date_actual": {
            "type": "string",
            "pattern": "^(?:(?:31(\\/)(?:0?[13578]|1[02]))\\1|(?:(?:29|30)(\\/)(?:0?[13-9]|1[0-2])\\2))(?:(?:1[6-9]|[2-9]\\d)?\\d{2})$|^(?:29(\\/)0?2\\3(?:(?:(?:1[6-9]|[2-9]\\d)?(?:0[48]|[2468][048]|[13579][26])|(?:(?:16|[2468][048]|[3579][26])00))))$|^(?:0?[1-9]|1\\d|2[0-8])(\\/)(?:(?:0?[1-9])|(?:1[0-2]))\\4(?:(?:1[6-9]|[2-9]\\d)?\\d{2})$",
            "minLength": 10,
            "maxLength": 10
        },
        "iterim_report_date_planed": {
            "type": "string",
            "pattern": "^(?:(?:31(\\/)(?:0?[13578]|1[02]))\\1|(?:(?:29|30)(\\/)(?:0?[13-9]|1[0-2])\\2))(?:(?:1[6-9]|[2-9]\\d)?\\d{2})$|^(?:29(\\/)0?2\\3(?:(?:(?:1[6-9]|[2-9]\\d)?(?:0[48]|[2468][048]|[13579][26])|(?:(?:16|[2468][048]|[3579][26])00))))$|^(?:0?[1-9]|1\\d|2[0-8])(\\/)(?:(?:0?[1-9])|(?:1[0-2]))\\4(?:(?:1[6-9]|[2-9]\\d)?\\d{2})$",
            "minLength": 10,
            "maxLength": 10
        },
        "iterim_report_date_actual": {
            "type": "string",
            "pattern": "^(?:(?:31(\\/)(?:0?[13578]|1[02]))\\1|(?:(?:29|30)(\\/)(?:0?[13-9]|1[0-2])\\2))(?:(?:1[6-9]|[2-9]\\d)?\\d{2})$|^(?:29(\\/)0?2\\3(?:(?:(?:1[6-9]|[2-9]\\d)?(?:0[48]|[2468][048]|[13579][26])|(?:(?:16|[2468][048]|[3579][26])00))))$|^(?:0?[1-9]|1\\d|2[0-8])(\\/)(?:(?:0?[1-9])|(?:1[0-2]))\\4(?:(?:1[6-9]|[2-9]\\d)?\\d{2})$",
            "minLength": 10,
            "maxLength": 10
        },
        "final_study_date_planed": {
            "type": "string",
            "pattern": "^(?:(?:31(\\/)(?:0?[13578]|1[02]))\\1|(?:(?:29|30)(\\/)(?:0?[13-9]|1[0-2])\\2))(?:(?:1[6-9]|[2-9]\\d)?\\d{2})$|^(?:29(\\/)0?2\\3(?:(?:(?:1[6-9]|[2-9]\\d)?(?:0[48]|[2468][048]|[13579][26])|(?:(?:16|[2468][048]|[3579][26])00))))$|^(?:0?[1-9]|1\\d|2[0-8])(\\/)(?:(?:0?[1-9])|(?:1[0-2]))\\4(?:(?:1[6-9]|[2-9]\\d)?\\d{2})$",
            "minLength": 10,
            "maxLength": 10
        },
        "final_study_date_actual": {
            "type": "string",
            "pattern": "^(?:(?:31(\\/)(?:0?[13578]|1[02]))\\1|(?:(?:29|30)(\\/)(?:0?[13-9]|1[0-2])\\2))(?:(?:1[6-9]|[2-9]\\d)?\\d{2})$|^(?:29(\\/)0?2\\3(?:(?:(?:1[6-9]|[2-9]\\d)?(?:0[48]|[2468][048]|[13579][26])|(?:(?:16|[2468][048]|[3579][26])00))))$|^(?:0?[1-9]|1\\d|2[0-8])(\\/)(?:(?:0?[1-9])|(?:1[0-2]))\\4(?:(?:1[6-9]|[2-9]\\d)?\\d{2})$",
            "minLength": 10,
            "maxLength": 10
        },
        "funding_companies_names": {
            "type": "string",
            "minLength": 1
        },
        "funding_companies_percentage": {
            "type": "number",
            "minimum": 0,
            "maximum": 100 
        },
        "funding_charities_names": {
            "type": "string",
            "minLength": 1
        },
        "funding_charities_percentage": {
            "type": "number",
            "minimum": 0,
            "maximum": 100 
        },
        "funding_government_body_names": {
            "type": "string",
            "minLength": 1
        },
        "funding_government_body_percentage": {
            "type": "number",
            "minimum": 0,
            "maximum": 100 
        },
        "funding_research_councils_names": {
            "type": "string",
            "minLength": 1
        },
        "funding_research_councils_percentage": {
            "type": "number",
            "minimum": 0,
            "maximum": 100 
        },
        "funding_eu_scheme_names": {
            "type": "string",
            "minLength": 1
        },
        "funding_eu_scheme_percentage": {
            "type": "number",
            "minimum": 0,
            "maximum": 100 
        },
        "funding_other_names": {
            "type": "array",
            "items": {
                "type": "string"
            },
            "minItems": 1,
            "uniqueItems": true
        },
        "funding_other_percentage": {
            "type": "array",
            "items": {
                "type": "number",
                "minimum": 0,
                "maximum": 100 
            },
            "minItems": 1,
            "uniqueItems": false
        },
        "substance_atc": {
            "type": "array",
            "items": {
                "type": "string",
                "minLength": 1
            },
            "minItems": 1,
            "uniqueItems": true
        },
        "substance_inn": {
            "type": "array",
            "items": {
                "type": "string",
                "minLength": 1
            },
            "minItems": 1,
            "uniqueItems": true
        },
        "medical_conditions": {
            "type": "array",
            "oneOf": [
                { 
                    "prefixItems": [
                        { "const": "Yes" }
                    ],
                    "items": {
                        "type": "string",
                        "minLength": 1
                    }
                },
                {
                    "prefixItems": [
                        { "const": "No" }
                    ],
                    "items": false
                }
            ],
            "minItems": 1,
            "$comment": "uniqueItems is not possible, because 2 out of 2535 have duplicate fields"
        },
        "additional_medical_conditions": {
            "type": "string",
            "minLength": 1
        },
        "age_population": {
            "type": "array",
            "items": {
                "type": "string",
                "enum": [
                    "Preterm newborns",
                    "Term newborns (0-27 days)",
                    "Infants and toddlers (28 days - 23 months)",
                    "Children (2 - 11 years)",
                    "Adolescents (12 - 17 years)",
                    "Adults (18 - 44 years)",
                    "Adults (45 - 64 years)",
                    "Adults (65 - 74 years)",
                    "Adults (75 years and over)"
                ]
            },
            "minItems": 1,
            "uniqueItems": true
        },
        "sex_population": {
            "type": "array",
            "items": {
                "type": "string",
                "enum": ["Male", "Female"]
            },
            "minItems": 1,
            "uniqueItems": true
        },
        "other_population": {
            "type": "array",
            "items": {
                "type": "string",
                "enum": [
                    "Renal impaired",
                    "Hepatic impaired",
                    "Immunocompromised",
                    "Pregnant women"
                ]
            },
            "minItems": 1,
            "uniqueItems": true
        },
        "number_of_subjects": {
            "type": "integer",
            "minimum": 0,
            "maximum": 1000000000
        },
        "uses_established_data_source": {
            "type": "string",
            "enum": ["Yes", "No"]
        },
        "data_sources_registered_with_encepp": {
            "type": "array",
            "items": {
                "type": "string",
                "minItems": 1
            },
            "minItems": 1,
            "uniqueItems": true
        },
        "data_sources_not_registered_with_encepp": {
            "type": "array",
            "items": {
                "type": "string",
                "minItems": 1
            },
            "minItems": 1,
            "uniqueItems": true
        },
        "data_source_types": {
            "type": "array",
            "items": {
                "type": "string",
                "minItems": 1
            },
            "minItems": 1,
            "uniqueItems": true
        },
        "scopes": {
            "type": "array",
            "items": {
                "type": "string",
                "minItems": 1
            },
            "minItems": 1,
            "uniqueItems": true
        },
        "primary_scope": {
            "type": "string",
            "pattern": "^Primary scope : "
        },
        "primary_outcomes": {
            "type": "array",
            "oneOf": [
                { 
                    "prefixItems": [
                        { "const": "Yes" }
                    ],
                    "items": {
                        "type": "string",
                        "minLength": 1
                    }
                },
                {
                    "prefixItems": [
                        { "const": "No" }
                    ],
                    "items": false
                }
            ],
            "minItems": 1,
            "maxItems": 2,
            "uniqueItems": true
        },
        "secondary_outcomes": {
            "type": "array",
            "oneOf": [
                { 
                    "prefixItems": [
                        { "const": "Yes" }
                    ],
                    "items": {
                        "type": "string",
                        "minLength": 1
                    }
                },
                {
                    "prefixItems": [
                        { "const": "No" }
                    ],
                    "items": false
                }
            ],
            "minItems": 1,
            "maxItems": 2,
            "uniqueItems": true
        },
        "study_design": {
            "type": "array",
            "items": {
                "type": "string",
                "minItems": 1
            },
            "minItems": 1,
            "uniqueItems": true
        },
        "follow_up": {
            "type": "string",
            "enum": ["Yes", "Not applicable/no follow-up"]
        },
        "protocol_document_url": {
            "type": "string",
            "pattern": "^/encepp/openAttachment/fullProtocol/\\d{4,6};jsessionid=\\S+!-?\\d{8,10}$"
        },
        "latest_protocol_document_url": {
            "type": "string",
            "pattern": "^/encepp/openAttachment/fullProtocolLatest/\\d{4,6};jsessionid=\\S+!-?\\d{8,10}$"
        },
        "result_document_url": {
            "type": "string",
            "pattern": "^/encepp/openAttachment/studyResult/\\d{4,6};jsessionid=\\S+!-?\\d{8,10}$"
        },
        "latest_result_document_url": {
            "type": "string",
            "pattern": "^/encepp/openAttachment/studyResultLatest/\\d{4,6};jsessionid=\\S+!-?\\d{8,10}$"
        },
        "references": {
            "type": "array",
            "items": {
                "type": "string",
                "pattern": "^(http|https)://"
            },
            "minItems": 1,
            "$comment": "uniqueItems is not possible, because 12 out of 2535 have duplicate fields"
        }
    }
}